<!DOCTYPE html>
<html lang="kr">
    <head>
        <title>BASECAMP</title>
    <link rel="shotcut icon" href="/public/img/common/campFire.ico" type="image/x-icon">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">    
        <script src="https://kit.fontawesome.com/7b271bba58.js" crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link rel="stylesheet" href="/public/css/common.css">
        
        <script src="/public/js/calendar.js"></script>
        <script src="/public/js/util.js"></script>
        <script src="/public/js/sellerPage.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <style>
            #genderChart, #ageChart {
                width: 100% !important;
                height: auto !important;
                max-width: 400px;
                max-height: 400px;
            }
            .chart-container {
                display: flex;
                flex-direction: column;
                align-items: center;
            }
        </style>
    </head>
    <body> 
         <div th:replace="~{camp/campNavi::topNaviSeller}"></div>
        <div class="container-fluid">
          <div class="row">

             <!-- 메뉴 -->
             <div th:replace="~{camp/campNavi::leftNavi}"></div>

             <!-- 본문 -->
             <div class="col right ms-2" style="padding-top: 58px; ">
                 <!-- 상단 바 -->
                 <div th:replace="~{camp/campNavi::topNavi}"></div>
 
                <!-- 내용 -->
                <div class="row scroll-list-box" style="margin-top: 100px; width: 1600px;">
                    <div class="col">
                        <div class="row new-mt-45 justify-content-center">
                            <div class="col-5 border rounded-2 me-5">
                                <div class="row my-1 align-items-center">
                                    <div class="col ms-3 my-2 fs-5 fw-bold">매출 통계</div>
                                    <div class="col-auto text-end pe-0">
                                        <span>날짜 검색</span>
                                    </div>
                                    <div class="col"><input type="date" class="form-control"></div>
                                    <div class="col-auto">~</div>
                                    <div class="col pe-1"> <input type="date" class="form-control"></div>
                                    <div class="col-auto"><i class="bi bi-search pe-2"></i></div>
                                </div>
                                <div class="row border-top pb-2">
                                    <div class="col mx-4">
                                        <div class="row mb-4">
                                            <canvas id="salesChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-5 border rounded-2 me-5">
                                <div class="row my-1">
                                    <div class="col ms-3 my-2 fs-5 fw-bold">최근 예약 수</div>
                                </div>
                                <div class="row border-top pb-2">
                                    <div class="col mx-4">
                                        <div class="row mb-4">
                                            <canvas id="visitorChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row new-mt-45 justify-content-center">
                            <div class="col-5 border rounded-2 me-5">
                                <div class="row my-1">
                                    <div class="col ms-3 my-2 fs-5 fw-bold">구역 예약 및 환불</div>
                                </div>
                                <div class="row border-top pb-2">
                                    <div class="col mx-4">
                                        <div class="row mb-4">
                                            <canvas id="purchaseRefundChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-5 border rounded-2 me-5">
                                <div class="row my-1">
                                    <div class="col ms-3 my-2 fs-5 fw-bold">남녀/나이별 캠핑장 방문자</div>
                                </div>
                                <div class="row border-top pb-2">
                                    <div class="col mt-4">
                                        <canvas id="genderChart"></canvas>
                                    </div>
                                    <div class="col mt-4">
                                        <canvas id="ageChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                         <!-- 기본 정보 -->
                        <!-- <div class="row new-mt-45 px-4 mx-5">
                            <div class="col">
                                <div class="row justify-content-center">
                                    <div class="col border rounded-2 me-5">
                                        <div class="row my-1">
                                            <div class="col-auto ms-3 my-1 fs-5 fw-bold">세부 통계</div>
                                        </div>
                                        <div class="row ps-1 pb-3 border-top">
                                            <div class="col mt-2">

                                                <div class="row mt-2">
                                                    <div class="col ms-3 me-5 pe-4">
                                                        <div class="row">
                                                            <div class="col text-secondary"></div>
                                                            <div class="col me-3 text-end fw-semibold">1</div>
                                                        </div>
                                                    </div>
                                                    <div class="col me-3 ms-5 ps-4">
                                                        <div class="row">
                                                            <div class="col text-secondary">2</div>
                                                            <div class="col  me-3 text-end fw-semibold">2</div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>

          </div>
        </div>
        <div th:replace="~{common/navi::popup}"></div>
        <script>
                document.addEventListener('DOMContentLoaded', (event) => {
               // 오늘부터 일주일 전까지의 날짜를 생성하는 함수
                function getLastSevenDays() {
                    const dates = [];
                    for (let i = 6; i >= 0; i--) {
                        const date = new Date();
                        date.setDate(date.getDate() - i);
                        const formattedDate = (date.getMonth() + 1) + '월 ' + date.getDate() + '일';
                        dates.push(formattedDate);
                    }
                    return dates;
                }

                // 기존 매출 통계 데이터
                const salesData = {
                    labels: getLastSevenDays(),
                    datasets: [{
                        label: '매출 (원화)',
                        data: [150000, 220000, 180000, 350000, 290000, 410000, 380000],
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                };

                const salesConfig = {
                    type: 'line',
                    data: salesData,
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString('ko-KR') + '원';
                                    }
                                }
                            }
                        }
                    }
                };

                // 새로운 방문자 통계 데이터
                const visitorData = {
                    labels: getLastSevenDays(),
                    datasets: [{
                        label: '예약자 수 (명)',
                        data: [50, 75, 60, 120, 90, 130, 150],
                        backgroundColor: 'rgba(75, 192, 75, 0.2)',
                        borderColor: 'rgba(75, 192, 75, 1)',
                        borderWidth: 1
                    }]
                };

                const visitorConfig = {
                    type: 'bar',
                    data: visitorData,
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString('ko-KR') + '명';
                                    }
                                }
                            }
                        }
                    }
                };

                        // 상품명 배열
                const productLabels = ['배존', '고추존', '밤존', '포도존'];

                // 구매 수 데이터
                const purchaseData = [120, 150, 180, 200];

                // 환불 수 데이터
                const refundData = [10, 20, 5, 15];

                const purchaseRefundData = {
                    labels: productLabels,
                    datasets: [
                        {
                            label: '예약 수 (건)',
                            data: purchaseData,
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 2,
                            fill: false
                        },
                        {
                            label: '환불 수 (건)',
                            data: refundData,
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2,
                            fill: false
                        }
                    ]
                };

                // Configuring the Chart
                const config = {
                    type: 'line',
                    data: purchaseRefundData,
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString('ko-KR') + '건';
                                    }
                                }
                            }
                        }
                    }
                };

               
                const ageGroups = ['10대', '20대', '30대', '40대', '50대 이상'];
                const ageGroupCounts = [10, 35, 25, 20, 15]; // 나이대별 방문자 수 예시

                const ageData = {
                    labels: ageGroups,
                    datasets: [{
                        label: '나이대별 방문자 수',
                        data: ageGroupCounts,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',  // 10대: 빨간색
                            'rgba(54, 162, 235, 0.7)',  // 20대: 파란색
                            'rgba(255, 206, 86, 0.7)',  // 30대: 노란색
                            'rgba(75, 192, 192, 0.7)',  // 40대: 녹색
                            'rgba(153, 102, 255, 0.7)'  // 50대 이상: 보라색
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)'
                        ],
                        borderWidth: 1
                    }]
                };

                const ageChartConfig = {
                    type: 'doughnut',
                    data: ageData,
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                align: 'center', // 범례를 가운데 정렬
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(tooltipItem) {
                                        return tooltipItem.label + ': ' + tooltipItem.raw.toLocaleString('ko-KR') + '명';
                                    }
                                }
                            },
                            datalabels: {
                                formatter: (value, context) => {
                                    return context.chart.data.labels[context.dataIndex] + '\n' + value.toLocaleString('ko-KR') + '명';
                                },
                                color: '#fff',
                                font: {
                                    weight: 'bold',
                                    size: 14
                                }
                            }
                        }
                    }
                };

                const maleCount = 32;  // 남성 방문자 수
                const femaleCount = 17;  // 여성 방문자 수

                const genderData = {
                    labels: ['남성', '여성'],
                    datasets: [{
                        label: '방문자 수',
                        data: [maleCount, femaleCount],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)', // 남성: 파란색
                            'rgba(255, 99, 132, 0.7)'  // 여성: 빨간색
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1,
                    }]
                };

                const config2 = {
                    type: 'doughnut',
                    data: genderData,
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                align: 'center', // 범례를 가운데 정렬
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(tooltipItem) {
                                        return tooltipItem.label + ': ' + tooltipItem.raw.toLocaleString('ko-KR') + '명';
                                    }
                                }
                            },
                            datalabels: {
                                formatter: (value, context) => {
                                    return context.chart.data.labels[context.dataIndex] + '\n' + value.toLocaleString('ko-KR') + '명';
                                },
                                color: '#fff',
                                font: {
                                    weight: 'bold',
                                    size: 14
                                }
                            }
                        }
                    }
                };

                // 차트를 렌더링합니다.
                const ctx2 = document.getElementById('genderChart').getContext('2d');
                new Chart(ctx2, config2);

                // 차트를 렌더링합니다.
                const ctx3 = document.getElementById('ageChart').getContext('2d');
                new Chart(ctx3, ageChartConfig);

                // Rendering the Chart
                const ctx = document.getElementById('purchaseRefundChart').getContext('2d');
                new Chart(ctx, config);

                // 매출 통계 차트 렌더링
                const salesCtx = document.getElementById('salesChart').getContext('2d');
                new Chart(salesCtx, salesConfig);

                // 방문자 통계 차트 렌더링
                const visitorCtx = document.getElementById('visitorChart').getContext('2d');
                new Chart(visitorCtx, visitorConfig);
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    </body>
</html>
