<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" >
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link rel="stylesheet" href="/public/css/common.css">
    
        <style>
            .fixed-button {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 1000; /* 필요에 따라 값 조정 */
                background-color: #007bff;
                color: white;
                width: 60px;
                height: 60px;
                padding: 10px 20px;
                border-radius: 50%;
                text-align: center;
                box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.3);
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .fixed-button i {
                font-size: 24px;
            }

            .top-image {
                width: 100%;
                height: auto;
            }

            .thin-icon {
            font-weight: 100; /* 두께를 얇게 설정 */
            }
            .normal-icon {
            font-weight: 400; /* 기본 두께 설정 */
            }
            .bold-icon {
            font-weight: 700; /* 두께를 두껍게 설정 */
            }

            .modal-content {
            border: none !important;
            }

            .fixed-size {
            width: 200px; /* 원하는 너비로 설정 */
            height: 200px; /* 원하는 높이로 설정 */
            object-fit: cover; /* 이미지 비율을 유지하면서 크기에 맞게 자르기 */
            }

            .navbar-custom {
            transition: background-color 0.3s, color 0.3s;
            }
            .navbar-transparent {
                background-color: transparent !important;
                color: white !important;
            }
            .navbar-solid {
                background-color: #f8f9fa !important;
                color: black !important;
            }
            .navbar-custom .btn, .navbar-custom .material-icons {
                transition: color 0.3s;
            }
        </style>

    </head>
    <body>
      
        <div class="container-fluid">
            <div class="row">
                <div class="col px-0">
                    <img th:src="|/images/${map.clubDto.main_image}|"style="width: 100%; height: 13em; object-fit: cover;" class="top-image">
                </div>
            </div>
        </div>

  
        <div class="container new-bg-gray px-0 overflow-x-hidden">
            <!-- 전체 박스 -->
                <div class="row px-4 pb-5 mb-5">
                    <div class="col">

                        <div class="row align-items-center pt-3">
                           
                            <div class="col">
                                <div class="row">
                                    <div class="col fs-5 fw-bold" th:text="${map.clubDto.name}">
                                        CLUB NAME
                                    </div>
                                </div>
                                <!-- <div class="row">
                                    <div class="col" style="font-size: 0.9em;">
                                        <span class="text-secondary" th:text="'모임장 ' + ${map.userDto.nickname}">모임장</span>
                                    </div>
                                </div> -->
                                <div class="row text-secondary">
                                    <div class="col-auto pe-0">
                                        멤버 <span th:text="${totalClubMember}"></span>
                                    </div>
                                    <div class="col-auto ps-1">
                                        <span th:text="' | 방문 ' +${countTodayVisit}"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto">
                                <div class="col" th:if="${session.sessionUserInfo != null}">
                                    <div class="row">
                                        <div class="col pe-1">
                                            <a th:if="${confirmBookmark == 0}" th:href="@{/club/bookmarkProcess(club_id=${map.clubDto.id}, user_id=${session.sessionUserInfo.id})}">
                                                <span><i class="bi bi-heart text-danger"></i></span>
                                            </a>
                                            <a th:unless="${confirmBookmark == 0}" th:href="@{/club/bookmarkProcess(club_id=${map.clubDto.id}, user_id=${session.sessionUserInfo.id})}">
                                                <span><i class="bi bi-heart-fill text-danger"></i></span>
                                            </a>
                                        </div>
                                        <div class="col ps-0 text-center text-danger" th:text="${totalBookmark}">
                                        </div>
                                    </div>
                                </div>
    
                                <div class="col-auto" th:if="${session.sessionUserInfo == null}">
                                    <div class="row">
                                        <div class="col pe-1">
                                            <a>
                                                <span><i class="bi bi-heart"></i></span>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col ps-0" th:text="${totalBookmark}">
                                        </div>
                                    </div>                                  
                                </div>
                            </div>
                        </div>

                        <div class="row border-bottom border-2 pb-4">
                            <div class="col">

                                <div class="row pt-3">
                                    <div class="col fw-semi-bold">
                                        모임 소개
                                    </div>
                                </div>
                                <div class="row pt-2" style="font-size: 0.9em;">
                                    <div class="col" th:text="${map.clubDto.description}">
                                        소모임 소개
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col">

                                <div class="row pt-3">
                                    <div class="col fw-semi-bold">
                                        모임 정보
                                    </div>
                                </div>

                                <div class="row pt-2">
                                    <div class="col d-flex align-items-center" style="font-size: 0.9em;">
                                        <span class="material-symbols-outlined thin-icon">
                                            map
                                            </span>
                                        &nbsp;활동 지역:&nbsp;<span th:text="${map.clubRegionCategoryDto.region_name}"></span>
                                    </div>
                                </div>
                                <div class="row pt-1">
                                    <div class="col d-flex align-items-center" style="font-size: 0.9em;">
                                        <span class="material-symbols-outlined thin-icon">
                                            account_circle
                                            </span>
                                        &nbsp;참여 인원:&nbsp;최대&nbsp;<span th:text="${map.clubDto.capacity}"></span>명
                                    </div>
                                </div>
                                <div class="row pt-1">
                                    <div class="col d-flex align-items-center" style="font-size: 0.9em;">
                                        <span class="material-symbols-outlined thin-icon">
                                            check_box
                                            </span>
                                            &nbsp;참여 조건:&nbsp;30대 | 성별무관 | 바로참여
                                    </div>
                                </div>
                            

                            </div>
                        </div>



                        <div class="row border-bottom border-4 pt-2 pb-3">
                            <div class="col"></div>
                        </div>

                        <div class="row pt-4 pb-2">
                            <div class="col fw-bold ps-0">
                                <span>정기모임</span>
                            </div>
                        </div>

                        <!-- 정기모임 박스 -->
                        <div class="row flex-nowrap overflow-x-auto" id="meeting-wrapper-box">
                            
                        </div>

                        <!-- <div class="row pt-3">
                            <div class="col">
                                <a href="" class="btn form-control btn-dark">정모 만들기</a>
                            </div>
                        </div> -->

                        <!--소모임 홈화면 모임멤버 목록 파트 -->
                        <div class="row">
                            <div class="col">

                                <div class="row pt-3 pb-1">
                                    <div class="col ps-0" style="font-size: 0.8em;">
                                        <span>모임멤버</span>
                                        <span class="fw-semi-bold" style="color: crimson;" th:text="${map.totalClubMember}"></span>
                                        <span th:text="' / ' +${map.clubDto.capacity}"></span>
                                    </div>


                                    <!-- <span>모임멤버 </span><div class="col-auto ps-0" style="font-size: 0.9em; color:crimson;" ></div>
                                </div> -->
                                    <div class="col pe-0 text-end" style="font-size: 0.8em;">
                                        <i class="bi bi-person-gear"></i> 멤버관리
                                    </div>
                            </div>
        
                                <div class="row">
                                    <div class="col">
                                            <div class="row">
                                                <div class="col px-0 input-group">
                                                <input type="text" th:value="${param.searchWord}" name="searchWord" class="form-control bg-body-tertiary" placeholder="검색어를 입력하세요.">
                                                    <button class="btn bg-body-tertiary border col-auto">
                                                        <i class="bi bi-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                    </div>
                                </div>
        
                                <div class="row pt-4">
                                    <div class="col ps-0" style="font-size: 0.8em;">
                                        최근 가입 <span><i class="bi bi-arrow-clockwise"></i></span>
                                    </div>
                                </div>
                               
                                <div class="row pt-2 pb-3" th:each="clubMemberData : ${clubMemberDataList}">
                                    <div class="col-1 px-0">
                                        <img th:if="${clubMemberData.userDto.profile_image == 'default'}" src="/public/img/clubImage/profile.jpg" class="img-fluid rounded-circle"  style="aspect-ratio: 1/1;">
                                        <img th:unless="${clubMemberData.userDto.profile_image == 'default'}" th:src="|/images/${clubMemberData.userDto.profile_image}|" class="img-fluid rounded-circle"  style="aspect-ratio: 1/1;">
                                    </div>
                                    <div class="col align-self-center">
                                        <div class="row">
                                            <div class="col pe-0 align-self-center" th:text="${clubMemberData.userDto.nickname}">
                                            </div>
                                            <div class="col ps-0 align-self-center text-secondary" style="font-size: 0.8em;" th:text="${#dates.format(clubMemberData.clubMemberDto.joined_at, 'yyyy.MM.dd')}"></div>
                                            <div class="col text-end">
                                                <i class="bi bi-send"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="row border-top py-3 mt-3">
                            <div class="col">
                                
                                <div class="row">
                                    <div class="col">
                                        <span>게시글</span>
                                    </div>
                                    <div class="col-auto text-end">
                                        <a th:href="@{/club/board(id=${id})}" style="text-decoration:none; color:black;"><span>전체보기 ></span></a>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="row border-top pt-3">
                            <div class="col">
                                
                                <div class="row">
                                    <div class="col">
                                        <span>사진첩</span>
                                    </div>
                                    <div class="col-auto text-end">
                                        <a th:href="@{/club/album(id=${id})}" style="text-decoration:none; color:black;"><span>전체보기 ></span></a>
                                    </div>
                                </div>

                            </div>
                        </div>
           

                    </div>
                </div>

                        <a th:if="${isMemberInClub == 1}" th:href="@{/club/createNewMeeting(id=${id})}" class="fixed-button bg-opacity-75 bg-dark">
                            <!-- <i class="bi bi-plus-circle-fill"></i> -->
                            <i class="bi bi-person-raised-hand"></i>
                        </a>
            </div>

            <!-- 상단 네비바 -->

            <div class="container fixed-top py-2 navbar-custom navbar-transparent">
                <div class="row">
                    <div class="col-auto navbar-brand fs-3" onclick="history.back()">
                        <i class="bi bi-chevron-left"></i>
                    </div>
                    <a th:href="@{/club/managementClub(id=${id})}" class="col align-self-center text-end fs-3 navbar-brand">
                        <span> <i class="bi bi-gear"></i></span>
                    </a>
                </div>
            </div>

            <div class="container fixed-bottom py-4" id="registerBtn" th:if="${session.sessionUserInfo != null && isMemberInClub == 0}">
                <div class="row pt-2 pb-3 text-center" th:if="${totalClubMember &lt; confirmCapacity}">
                    <div class="col">
                        <span id="register-club-btn" class="btn form-control btn-dark">가입하기</span>
                    </div>
                </div>
                <div class="row text-center" th:unless="${totalClubMember &lt; confirmCapacity}">
                    <div class="col text-danger">
                        <p class="border py-2 rounded text-bg-danger">모집인원이 마감되었습니다.</p>
                    </div>
                </div>
            </div>
         


            <!-- 가입조건 확인 모달 -->
             <!-- 레이아웃이 같은 모달은 재활용이 가능 -->
            <div class="modal fade" id="joinModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-body py-4">

                            <div class="row">
                                <div class="col text-center">
                                    <span>모임장이 지정한 성별 또는 나이 조건에 맞지 않아 가입할 수 없습니다.</span>
                                </div>
                            </div>
                            <div class="row pt-3">
                                <div class="col">
                                    <div class="btn btn-success form-control" onclick="joinFailHideModal()">확인</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="joinSuccessModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-body py-4">
                            <div class="row">
                                <div class="col text-center">
                                    <span>가입이 완료되었습니다.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- 정기모임 템플릿 -->
            <div class="row d-none" id="meeting-template">
                <div class="col-11 me-2 meeting-wrapper pt-2 pb-3 border rounded shadow-sm">

                    <div class="row">
                        <div class="col" style="font-size: 0.8em;">
                            <span class="meetingDate"></span>
                            <!-- <span th:text="${#dates.format(meetingData.clubMeetingDto.meeting_date,'MM/dd')}"> </span> -->
                            <span class="text-danger"> D-4</span>
                        </div>
                        <div class="col text-end text-secondary" style="font-size: 0.8em;">
                            <span>수정</span>
                        </div>
                    </div>
                    <div class="row pb-1 pt-1">
                        <div class="col fw-bold" style="font-size: 0.9em;">
                            <span class="meetingName"></span>
                            <!-- <span th:text="${meetingData.clubMeetingDto.name}"></span> -->
                        </div>
                    </div>
                    <div class="row pb-2 mb-2">
                        <div class="col" style="font-size: 0.8em;">
                            <span class="meetingDescription"></span>
                            <!-- <span th:text="${meetingData.clubMeetingDto.description}"></span> -->
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col-4 pe-0">  
                                    <img class="rounded-2 meetingImage" style="width: 100%; height: 100%;">
                                </div>
                                <div class="col" style="font-size: 0.8em;">
                                    <div class="row">
                                        <div class="col">
                                            <span class="text-secondary">일시</span>
                                            <span class="meetingDetailDate"></span>
                                            <!-- <span th:text="${#dates.format(meetingData.clubMeetingDto.meeting_date, 'yyyy.MM.dd')}"></span> -->
                                        </div>   
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <span class="text-secondary">위치</span>
                                            <span class="meetingLocation"></span>
                                        </div>   
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <span class="text-secondary">비용</span>
                                            <span class="meetingFee"></span>
                                        </div>   
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <span class="text-secondary">참석</span> 
                                            <span class="text-danger totalJoinMember"></span> / <span class="capacity"></span>
                                            <span class="text-secondary remainCapacity"></span>
                                        </div>   
                                    </div>
                                </div>
                                <div class="col-auto align-self-center">
                                    <div class="row">
                                        <div class="col">
                                            <button type="button" class="btn btn-outline-secondary join-meeting-btn">참석</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        
            <script>
                window.addEventListener('scroll', function() {
                    var navbar = document.querySelector('.navbar-custom');
                    if (window.scrollY > 50) {
                        navbar.classList.remove('navbar-transparent');
                        navbar.classList.add('navbar-solid');
                    } else {
                        navbar.classList.remove('navbar-solid');
                        navbar.classList.add('navbar-transparent');
                    }
                });
            </script>
   
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/public/js/club/clubHome.js"></script>
    </body>
</html>