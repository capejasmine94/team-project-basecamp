<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://kit.fontawesome.com/7b271bba58.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/public/css/font.css">

    <link rel="stylesheet" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap">

    <script src="/public/js/lockLikeMobile.js"></script>

    <title>회원가입</title>

    <style>

        body {
            font-family: "Noto Sans KR", sans-serif;
            font-optical-sizing: auto;
            font-style: normal;
        }   
        .fill-on {
            font-variation-settings: 'FILL' 1;
        }
        .fill-off {
            font-variation-settings: 'FILL' 0;
        }
        .seller_profile img{
            aspect-ratio: 1/1;
            width: 100px;
            object-fit: cover;
            object-position: center;
        }
        .icon-col img{
            aspect-ratio: 1/1;
            width: 100%;
            object-fit: cover;
            object-position: center;
        }
        .product-col img{
            aspect-ratio: 1/1;
            width: 100%;
            object-fit: cover;
            object-position: center;
        }
        a{
            text-decoration: none;
            color: black;
        }
        button{
            color: black;
        }
        .f05{
            font-size: 0.5em;
        }
        .f08{
            font-size: 0.8em;
        }
        .f09{
            font-size: 0.9em;
        }
        .f12{
            font-size: 1.2em;
        }
        .f15{
            font-size: 1.5em;
        }
        .f17{
            font-size: 1.7em;
        }
        .f20{
            font-size: 2em;
        }
        .f40{
            font-size: 4em;
        }
        .active{
            font-weight: bold;
            border-bottom: 2px solid black;
        }
        .borderInput{
            border: 0px;
            border-bottom: 1.2px solid rgb(220, 220, 220);
        }
        .borderInput:focus{
            outline: none;
            border-bottom: 1.2px solid #5e9cc8;
        }
        .borderInput::placeholder{
            font-size: 0.9em;
        }
        .btn-outline-dark {
            --bs-btn-color: rgb(95, 95, 95);
            --bs-btn-border-color: #efefef;
            --bs-btn-bg: #f9f9f9;

            --bs-btn-focus-shadow-rgb: 33, 37, 41;

            --bs-btn-active-color: #fff;
            --bs-btn-active-bg: #212529;
            --bs-btn-active-border-color: #212529;
            --bs-btn-active-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
            
            --bs-gradient: none;
        }
    </style>
</head>
<body>
    <!-- top-nav -->
    <div class="container-fluid fixed-top">
        <div class="row bg-white py-3 bg-opacity-75 align-items-center">
            <a class="col-auto d-flex align-items-center" id="backButton" onclick="history.back()">
                <span class="material-symbols-outlined fw-light">
                    arrow_back
                </span>
            </a>
            <div class="col fw-semibold text-center">
                회원가입
            </div>
            <a href="/" class="col-auto d-flex align-items-center text-black">
                <span class="material-symbols-outlined fw-light">
                    home
                </span>
            </a>
        </div>
    </div>

    <div class="container" style="padding-top: 60.792px;">
        <div class="row">
            <div class="col">

                <div class="row py-4">
                    <div class="col">
                        <div class="row pb-1 fw-semibold f15">
                            <div class="col">
                                회원님의 소중한 정보를
                            </div>
                        </div>
                        <div class="row pb-4 fw-semibold f15">
                            <div class="col">
                                입력해 주세요
                            </div>
                        </div>
                        <div class="row">
                            <div class="col f08">
                                아이디, 비밀번호, 이메일을 입력해 주세요. 마케팅 정보 수신 항목에 동의하시면 다양한 이벤트, 신상품 등 여러 정보를 보내드립니다. 항목에 동의하지 않아도 서비스 가입 및 이용 가능합니다.
                            </div>
                        </div>
                    </div>
                </div>

                <form action="/user/registerProcess" id="registerForm" method="post" class="row pt-4">
                    <div class="col">
                        <div class="row d-flex align-items-bottomline">
                            <div class="col fw-semibold">
                                정보입력
                            </div>
                            <div class="col f08 text-end text-body-tertiary">
                                <span class="text-danger">*</span>표시 필수 입력
                            </div>
                        </div>

                        <div class="row pt-3">
                            <div class="col f08">
                                아이디<span class="text-danger">*</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid position-relative">
                                <input type="text" name="account" class="py-3 px-2 borderInput" oninput="checkAccountID()" onfocus="idInfo()" id="inputId" th:value="'u'+${userCount}" placeholder="아이디 입력">
                                <div id="confirmResult" class="position-absolute f08" style="left: 1em; top: 4.5em;"></div>
                            </div>
                        </div>

                        <div class="row pt-5">
                            <div class="col f08">
                                비밀번호<span class="text-danger">*</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid">
                                <input type="password" name="password" class="py-3 px-2 borderInput" id="inputPw" value="1234" placeholder="비밀번호 입력">
                            </div>
                        </div>
                       
                        <div class="row pt-5">
                            <div class="col f08">
                                비밀번호 확인<span class="text-danger">*</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid position-relative">
                                <input type="password" class="py-3 px-2 borderInput" onkeyup="checkAccountPwConfirm()" id="inputPwConfirm" value="1234" placeholder="비밀번호 재입력">
                                <div id="confirmAccountPw" class="position-absolute f08 text-danger" style="left: 1em; top: 4.5em;"></div>
                            </div>
                        </div>

                        <div class="row pt-5">
                            <div class="col f08">
                                닉네임<span class="text-danger">*</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid">
                                <input type="text" id="inputNickname" name="nickname" class="py-3 px-2 borderInput" th:value="${userNick}" placeholder="닉네임 입력">
                            </div>
                        </div>

                        <div class="row pt-5">
                            <div class="col f08">
                                이메일<span class="text-danger">*</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid">
                                <input type="text" id="inputEmail" name="email" class="py-3 px-2 borderInput" th:value="${email}" placeholder="이메일 입력">
                            </div>
                        </div>
                        
                        <div class="row pt-5">
                            <div class="col f08">
                                이름
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid">
                                <input type="text" id="inputName" name="name" class="py-3 px-2 borderInput" th:value="'유저'+${userCount}" placeholder="이름 입력">
                            </div>
                        </div>

                        <div class="row pt-5">
                            <div class="col f08">
                                휴대폰번호
                            </div>
                        </div>
                        <div class="row">
                            <div class="col d-grid">
                                <input type="text" name="phone" id="inputPhone" class="py-3 px-2 borderInput" maxlength="13" oninput="formatPhoneNumber(this)" placeholder="전화번호 입력" th:value="${phone}">
                            </div>
                        </div>

                        <div class="row pt-5">
                            <div class="col f08">
                                성별
                            </div>
                        </div>
                        <div class="row pt-2">
                            <div class="col pe-0 d-grid">
                                <input type="radio" id="genderOption1" class="btn-check" name="gender" value="M" checked>
                                <label for="genderOption1" class="btn btn-outline-dark rounded-1 f08 py-2">남자</label>
                            </div>
                            <div class="col d-grid">
                                <input type="radio" id="genderOption2" class="btn-check" name="gender" value="F">
                                <label for="genderOption2" class="btn btn-outline-dark rounded-1 f08 py-2">여자</label>
                            </div>
                        </div>
                        

                        <div class="row pt-5">
                            <div class="col f08">
                                생년월일
                            </div>
                        </div>
                        <div class="row pt-2">
                            <div class="col d-grid">
                                <input type="date" name="birth" id="inputBirth" class="border col py-2 px-2 bg-white rounded-0 borderInput"  th:value="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
                            </div>
                        </div>
                    </div>
                </form>
                <div class="row py-5"></div>
                <div class="row py-5"></div>

            </div>
        </div>
    </div>

    <div class="container-fluid bg-white fixed-bottom">
        <div class="row px-2 pt-3 pb-4 border-top">
            <div class="col text-center d-grid">
                <button type="button"  onclick="formSubmit()" class="btn btn-dark rounded-0 f09 fw-semibold py-2">확인</button>
            </div>
        </div>
    </div>

    <script>
        function checkAccountID(){
            const inputId = document.getElementById("inputId");
            const confirmResult = document.getElementById("confirmResult");

            if(inputId.value==""){
                confirmResult.innerText = "아이디를 입력해주세요";
                confirmResult.classList.add("text-danger")
                inputId.classList.add("border-bottom")
                inputId.classList.add("border-danger")
                return;
            }

            const url = `/api/user/isExistAccount?id=${inputId.value}`
            fetch(url)
            .then(response => response.json())
            .then((response) => {
                if(response.data.isExist){
                    confirmResult.innerText = "이미 사용중인 아이디입니다";
                    confirmResult.classList.add("text-danger")
                    inputId.classList.add("border-bottom")
                    inputId.classList.add("border-danger")
                }else{
                    confirmResult.innerText = "";
                    confirmResult.classList.remove("text-danger")
                    inputId.classList.remove("border-bottom")
                    inputId.classList.remove("border-danger")
                }
            })
        }

        function idInfo(){
            const confirmResult = document.getElementById("confirmResult");
            const inputId = document.getElementById("inputId")
            confirmResult.classList.remove("text-danger")
            inputId.classList.remove("border-bottom")
            inputId.classList.remove("border-danger")
            confirmResult.style.color = '#5e9cc8'
            confirmResult.innerText = "영문 소문자+숫자 조합 6~12자리 사용 가능합니다."
        }

        function checkAccountPwConfirm(){
            const inputPw = document.getElementById("inputPw");
            const inputPwConfirm = document.getElementById("inputPwConfirm");
            
            const confirmAccountPw = document.getElementById("confirmAccountPw");

            if(inputPw.value == inputPwConfirm.value){
                confirmAccountPw.innerText = "";
                inputPwConfirm.classList.remove("border-bottom")
                inputPwConfirm.classList.remove("border-danger")
            }else{
                confirmAccountPw.innerText = "비밀번호가 일치하지 않습니다";
                inputPwConfirm.classList.add("border-bottom")
                inputPwConfirm.classList.add("border-danger")
            }
        }

        function validateNumberInput(input){
            input.value = input.value.replace(/[^0-9]/g, '');
            if (input.value.length > 4) {
                input.value = input.value.slice(0, 4);
            }
        }

        function formatPhoneNumber(input) {
            let value = input.value.replace(/[^0-9]/g, ''); // 숫자 외의 문자 제거
            let formattedValue = '';

            if (value.length > 3) {
                formattedValue += value.substring(0, 3) + '-';
                if (value.length > 7) {
                    formattedValue += value.substring(3, 7) + '-';
                    formattedValue += value.substring(7, 11);
                } else {
                    formattedValue += value.substring(3, 7);
                }
            } else {
                formattedValue += value;
            }

            input.value = formattedValue;
        }

        function formSubmit(){

            const inputId = document.getElementById("inputId");
            const confirmResult = document.getElementById("confirmResult");
            if(inputId.value == '' || confirmResult.innerText=="이미 사용중인 아이디입니다") {
                inputId.focus();
                return;
            }

            const inputPw = document.getElementById("inputPw");
            if(inputPw.value == '') {
                inputPw.focus();
                return;
            }

            const inputPwConfirm = document.getElementById("inputPwConfirm");
            const confirmAccountPw = document.getElementById("confirmAccountPw");
            if(inputPw.value != inputPwConfirm.value){
                confirmAccountPw.innerText = "비밀번호가 일치하지 않습니다";
                inputPwConfirm.focus();
                return;
            }

            const inputNickname = document.getElementById("inputNickname");
            if(inputNickname.value == ''){
                inputNickname.focus();
                return;
            }

            const inputEmail = document.getElementById("inputEmail");
            if(inputEmail.value == ''){
                inputEmail.focus();
                return;
            }

            const inputName = document.getElementById("inputName");
            if(inputName.value == ''){
                inputName.focus();
                return;
            }
            
            const inputPhone = document.getElementById("inputPhone");
            if(inputPhone.value == ''){
                inputPhone.focus();
                return;
            }

            const inputBirth = document.getElementById("inputBirth");
            if(inputBirth.value == ''){
                inputBirth.focus();
                return;
            }

            //아이디 중복검사
            //이메일인증, 유효성검사

            const registerForm = document.getElementById("registerForm");
            registerForm.submit();
        }
    </script>

</body>
</html>