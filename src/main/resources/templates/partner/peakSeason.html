<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/7b271bba58.js" crossorigin="anonymous"></script>
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
    <!-- partner 오른쪽 본문 css -->
    <link href="/public/css/campingcar/right-content.css" rel="stylesheet">
    <link href="/public/css/common.css" rel="stylesheet">
    <!-- 이미지 js -->
    <script src="/public/js/util.js"></script>
    <!-- Datepicker CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" rel="stylesheet">

    <style>
/* --------------------- 달력 컨트롤과 범례의 전체적인 레이아웃 설정 ---------------------*/
        .calendar-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            position: relative;
        }

        .calendar-controls .navigation {
            display: flex;
            justify-content: center;
            align-items: center;
            position: absolute;
            left: 50%;
            transform: translateX(-80%);
        }

        .btn-icon {
            background: none;
            border: none;
            color: #6c757d;
            cursor: pointer;
            padding: 5px 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background-color: #f8f9fa;
        }

        #monthYear {
            font-size: 20px;
            font-weight: bold;
            margin: 0 15px;
        }

        .calendar-controls .legend {
            display: flex;
            justify-content: flex-end;
            flex-grow: 1;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-left: 20px;
            font-size: 14px;
        }

        .dot {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            margin-right: 5px;
            display: inline-block;
        }
        .high-season .dot { background-color: #f8d7da; }
        .mid-season .dot { background-color: #fff3cd; }
        .designated-period .dot { background-color: #d1ecf1; }
        .holiday .dot { background-color: #cccccc; }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: center !important;
            vertical-align: middle !important;
            height: 60px !important;
            padding: 0 !important;
            font-weight: bold !important;
            font-size: 18px !important;
        }

        td {
            padding: 12px;
            border: 1px solid #dee2e6;
            text-align: left; /* 셀 안의 텍스트를 왼쪽 정렬 */
            vertical-align: top; /* 셀 안의 텍스트를 상단 정렬 */
            height: 80px; /* 셀의 높이를 고정 */
        }

        .date-cell {
            padding: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .date-cell:hover {
            background-color: #e9ecef;
        }

        .sunday {
            color: red;
        }

        .selected-day {
            border: 2px solid red;
        }

        .inactive {
            color: #dcdcdc;
        }

        /* 이전/다음 달 날짜 스타일 */
        .other-month {
            color: #999999;
        }

        /* 이전/다음 달 날짜에 muted 스타일 적용 */
        .text-muted {
            color: #6c757d !important;
        }
        /* 셀안의 날짜 굵기 */
        .date-cell .calendar-date {
            font-weight: 600; /* semibold 설정 */
        }

        /* 셀안의 차량 정보 굵기 */
        .date-cell .car-info {
            font-weight: 400; /* normal 설정 */
        }
/* --------------------- 모달부분 --------------------- */
        .modal-header .close {
            margin: -1rem -1rem -1rem auto;
        }

        /* Custom Modal Styles */
        .modal-custom {
            display: none;
            position: fixed;
            z-index: 1050;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            outline: 0;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-dialog-custom {
            position: relative;
            margin: 10rem auto;
            max-width: 500px;
            width: 90%;
        }

        .modal-content-custom {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.3);
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-header-custom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .modal-title-custom {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .btn-close-custom {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body-custom {
            margin-bottom: 20px;
        }

        .form-label {
            font-size: 0.875rem;
            color: #495057;
            margin-bottom: 5px;
        }

        .form-check-label {
            font-size: 0.875rem;
            color: #495057;
        }

        .form-check-input {
            margin-right: 5px;
        }

        .modal-footer-custom {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-custom {
            padding: 8px 16px;
            font-size: 0.875rem;
            font-weight: 500;
            border-radius: 4px;
            cursor: pointer;
            border: none;
        }

        .btn-secondary-custom {
            background-color: #6c757d;
            color: #fff;
        }

        .btn-primary-custom {
            background-color: #007bff;
            color: #fff;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .radio-item {
            display: flex;
            align-items: center;
        }

        .radio-item input {
            margin-right: 5px;
        }

        .modal-open .modal-custom {
            display: block;
        }
    </style>
</head>
<body>
    <div th:replace="~{partner/carNavi::topNavi}"></div>
    <div class="container-fluid">
        <div class="row">
            <div th:replace="~{partner/carNavi::leftNavi}"></div>
            <!-- right -->
            <div class="col right bg-body-secondary" style="padding-top: 55px;">
                <div class="row py-3 px-4 d-flex align-items-center bg-white">
                    <div class="col fs-6 fw-semibold">
                        성수기·휴일
                    </div>
                </div>
                <!-- 본문내용(templets) -->
                <div class="row px-4 pt-3">
                    <div class="col px-0">
                        <div class="card">
                            <div class="card-head fw-semibold py-3 px-3">
                                <head>성수기/휴무 관리</head>
                                <div class="card-body">
                                    <div class="form-group">
                                        <div class="row font-robot">
                                            <div class="col margin-0">
                                                <div class="alert alert-info border-5 border-top-0 border-end-0 border-bottom-0 border-primary-subtle fw-normal new-fs-9" style="background: #FAFAFA;">
                                                    기간이 겹칠 경우 하위에 배치된 기간이 우선으로 적용됩니다. (드래그로 순서 변경 가능)
                                                    <div class="fw-normal"><span style="color: red;">단 타입이 휴무로 설정된 경우,</span> 우선순위와 관계 없이 휴무일로 적용됩니다.</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row font-roboto">
                                            <div class="col">
                                                <table class="table table-hover" style="text-align: center;">
                                                    <thead>
                                                      <tr>
                                                        <th scope="col">no</th>
                                                        <th scope="col">타입</th>
                                                        <th scope="col">기간명</th>
                                                        <th scope="col">기간</th>
                                                        <th scope="col">수정/삭제</th>
                                                      </tr>
                                                    </thead>
                                                    <tbody style="font-weight:normal;">
                                                        <tr>
                                                            <th scope="row" style="font-weight:normal;">1</th>
                                                            <td>성수기</td>
                                                            <td>성수기</td>
                                                            <td>2024-07-17~2024-07-17</td>
                                                            <td>
                                                                <a href="/admin/peekEdit"><span class="material-symbols-outlined">edit</span></a>
                                                                <a href="/admin/peekdelete"><span class="ps-2 material-symbols-outlined">delete</span></a>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th scope="row" style="font-weight:normal;">2</th>
                                                            <td>성수기</td>
                                                            <td>성수기</td>
                                                            <td>2024-07-18~2024-07-18</td>
                                                            <td>
                                                                <a href="/admin/peekEdit"><span class="material-symbols-outlined">edit</span> </a>
                                                                <a href="/admin/peekdelete"><span class="ps-2 material-symbols-outlined">delete</span></a>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <th scope="row" style="font-weight:normal;">3</th>
                                                            <td>성수기</td>
                                                            <td>성수기</td>
                                                            <td>2024-07-19~2024-07-19</td>
                                                            <td> 
                                                                <a href="/admin/editPeriod"><span class="material-symbols-outlined">edit</span> </a>
                                                                <a href="/admin/deletePeriod"><span class="ps-2 material-symbols-outlined">delete</span></a>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <a href="admin/peekAddPeriod">기간설정 추가</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row px-4 pt-3">
                    <div class="col px-0">
                        <div class="card">
                            <div class="card-head fw-semibold py-3 px-3">
                                <head>기간 및 가격 확인</head>
                                <div class="card-body">
                                    <div class="form-group">
                                        <div class="calendar-controls">
                                            <div class="navigation">
                                                <button id="prevMonth" class="btn-icon">
                                                    <span class="material-symbols-outlined">chevron_left</span>
                                                </button>
                                                <span id="monthYear"></span>
                                                <button id="nextMonth" class="btn-icon">
                                                    <span class="material-symbols-outlined">chevron_right</span>
                                                </button>
                                            </div>
                                            <div class="legend">
                                                <span class="legend-item high-season"><span class="dot"></span>성수기</span>
                                                <span class="legend-item mid-season"><span class="dot"></span>준성수기</span>
                                                <span class="legend-item designated-period"><span class="dot"></span>지정기간</span>
                                                <span class="legend-item holiday"><span class="dot"></span>휴일</span>
                                            </div>
                                        </div>
                                        <div id="calendar_peak"></div><!-- 달력이 표시될 부분 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- modal -->
               
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">기간설정</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="radio-group">
                        <label class="radio-item">
                            <input type="radio"  value="peak" checked> 성수기
                        </label>
                        <label class="radio-item">
                            <input type="radio" value="mid-peak"> 준성수기
                        </label>
                        <label class="radio-item">
                            <input type="radio"  value="discount"> 할인기간
                        </label>
                        <label class="radio-item">
                            <input type="radio" value="designated"> 지정기간
                        </label>
                        <label class="radio-item">
                            <input type="radio" value="holiday"> 휴무
                        </label>
                    </div>
                    <form>
                        <div class="mb-3">
                            <label class="form-label">기간명</label>
                            <input type="text" class="form-control custom-bottom-border" id="periodName" placeholder="예: 여름 성수기">
                        </div>
                        <div class="mb-3">
                            <div class="row">
                                <div class="col">
                                    <label for="startDate" class="form-label">시작일</label>
                                    <input type="text" name="weekdays_price" class="form-control custom-bottom-border" id="startDate" readonly>
                                </div>
                                <div class="col">
                                    <label for="endDate" class="form-label">종료일</label>
                                    <input type="text" name="weekend_price" class="form-control custom-bottom-border" id="endDate" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="repeatAnnually">
                            <label class="form-check-label" for="repeatAnnually">
                                매년 반복
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="inputPeakData()">추가</button>
                </div>
            </div>
        </div>
    </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.ko.min.js"></script>
    <script src="/public/js/campingcar/partnermain.js"></script>
    <script>
        let currentDate = new Date();

        // 페이지가 로드되면 현재 날짜를 기준으로 달력을 생성하고, 데이터를 가져옵니다.
        document.addEventListener('DOMContentLoaded', function () {
            loadCalendarData(currentDate.getFullYear(), currentDate.getMonth());
        });

        // 이전 달 버튼 클릭 시 현재 월을 이전 달로 설정하고 달력을 갱신합니다.
        document.getElementById('prevMonth').addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            loadCalendarData(currentDate.getFullYear(), currentDate.getMonth());
        });

        // 다음 달 버튼 클릭 시 현재 월을 다음 달로 설정하고 달력을 갱신합니다.
        document.getElementById('nextMonth').addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            loadCalendarData(currentDate.getFullYear(), currentDate.getMonth());
        });

        // 달력을 생성하고 데이터를 가져오는 함수
        function loadCalendarData(year, month) {
            // 서버에서 해당 월의 차량 데이터를 가져옵니다
            fetchCampingCarListForCalendar(year, month).then(carList => {
                // 달력을 생성하면서, 데이터를 함께 렌더링
                createDynamicCalendar(year, month, carList);
            });
        }

        // 동적으로 달력을 생성하는 함수입니다. carList 데이터를 받아와 각 셀에 데이터를 추가합니다.
        function createDynamicCalendar(year, month, carList, userDefinedPeriods = []) {
    const container = document.getElementById('calendar_peak');
    container.innerHTML = ''; // 기존 달력을 지웁니다.
    document.getElementById('monthYear').textContent = `${year}년 ${month + 1}월`; // 현재 연도와 월을 표시합니다.

    const table = document.createElement('table');
    table.className = 'table calendar-table'; // Bootstrap 스타일 적용
    const header = table.createTHead();
    const headerRow = header.insertRow();
    const daysOfWeek = ['일', '월', '화', '수', '목', '금', '토'];
    daysOfWeek.forEach(day => {
        const cell = headerRow.insertCell();
        cell.textContent = day;
        cell.className = 'text-center fw-semibold'; // 중앙 정렬 및 강조된 스타일 적용
    });

    const body = table.createTBody();
    const firstDay = new Date(year, month, 1).getDay(); // 해당 월의 첫 번째 날의 요일을 계산합니다.
    const daysInMonth = new Date(year, month + 1, 0).getDate(); // 해당 월의 일수를 계산합니다.
    const previousMonthDays = new Date(year, month, 0).getDate(); // 이전 달의 총 일수를 계산합니다.

    let date = 1; // 현재 월의 날짜를 추적하는 변수입니다.
    let nextMonthDate = 1; // 다음 달의 날짜를 추적하는 변수입니다.

    for (let i = 0; i < 6; i++) { // 최대 6주를 생성합니다.
        const row = body.insertRow();
        for (let j = 0; j < 7; j++) { // 7일을 생성합니다.
            const cell = row.insertCell();
            cell.className = 'date-cell'; // 날짜 셀의 기본 스타일을 설정합니다.
            if (j === 0) {
                cell.classList.add('sunday'); // 일요일은 빨간색으로 표시됩니다.
            }
            if (i === 0 && j < firstDay) {
                // 이전 달의 날짜를 표시
                const prevDate = previousMonthDays - (firstDay - j - 1);
                const dateDiv = document.createElement('div');
                dateDiv.className = 'calendar-date';
                dateDiv.textContent = prevDate;
                cell.appendChild(dateDiv);
                cell.classList.add('text-muted'); // 이전 달 날짜에 muted 스타일을 추가합니다.
                cell.onclick = function() {
                    selectDay(cell, year, month - 1, prevDate); // 이전 달의 날짜를 클릭할 때 선택 가능하도록 설정
                };
            } else if (date > daysInMonth) {
                // 다음 달의 날짜를 표시
                const currentNextMonthDate = nextMonthDate; // 클로저로 값을 캡처
                const dateDiv = document.createElement('div');
                dateDiv.className = 'calendar-date';
                dateDiv.textContent = currentNextMonthDate;
                cell.appendChild(dateDiv);
                cell.classList.add('text-muted'); // 다음 달 날짜에 muted 스타일을 추가합니다.
                cell.onclick = function() {
                    selectDay(cell, year, month + 1, currentNextMonthDate); // 다음 달의 날짜를 클릭할 때 선택 가능하도록 설정
                };
                nextMonthDate++;
            } else {
                const currentDay = date; // 현재 날짜를 클로저로 캡처합니다.
                const dateDiv = document.createElement('div');
                dateDiv.className = 'calendar-date';
                dateDiv.textContent = currentDay;
                cell.appendChild(dateDiv);
                cell.setAttribute('data-date', date); // 날짜 셀에 data-date 속성 추가
                cell.onclick = function() {
                    selectDay(cell, year, month, currentDay); // 선택된 날짜로 함수를 호출합니다.
                };

                // 성수기 기간에 해당하는 날짜인지 확인하고 스타일 적용
                const isPeakPeriod = carList.some(car => {
                    const startDate = new Date(car.peak_start_date);
                    const endDate = new Date(car.peak_end_date);
                    const currentDate = new Date(year, month, currentDay);
                    return currentDate >= startDate && currentDate <= endDate;
                });

                // 사용자 정의 성수기 기간 확인
                const isUserDefinedPeakPeriod = userDefinedPeriods.some(period => {
                    const startDate = new Date(period.startDate);
                    const endDate = new Date(period.endDate);
                    const currentDate = new Date(year, month, currentDay);
                    return currentDate >= startDate && currentDate <= endDate;
                });

                // 사용자 정의 성수기 기간명 적용
                if (isUserDefinedPeakPeriod) {
                    const userPeriodName = userDefinedPeriods.find(period => {
                        const startDate = new Date(period.startDate);
                        const endDate = new Date(period.endDate);
                        const currentDate = new Date(year, month, currentDay);
                        return currentDate >= startDate && currentDate <= endDate;
                    })?.periodName;

                    if (userPeriodName) {
                        const userPeriodNameDiv = document.createElement('div');
                        userPeriodNameDiv.textContent = userPeriodName;
                        userPeriodNameDiv.style.color = '#f8d7da';
                        userPeriodNameDiv.className = 'fw-bold';
                        cell.appendChild(userPeriodNameDiv);
                    }
                }

                // 차량 정보를 해당 날짜 셀에 추가
                carList.forEach(car => {
                    console.log("car",car);
                    const dayOfWeek = new Date(year, month, currentDay).getDay(); // 요일을 가져옵니다 (0: 일요일, 6: 토요일)
                    const carInfo = document.createElement('div');
                    carInfo.className = 'car-info'; // 차량 정보에 대한 클래스 지정

                    // 현재 날짜가 성수기 기간 내에 있는지 확인
                    const currentDate = new Date(year, month, currentDay);
                    const peakStartDate = new Date(car.peak_start_date);
                    const peakEndDate = new Date(car.peak_end_date);

                    console.log("currentDate",currentDate);
                    console.log("peakStartDate",peakStartDate);
                    console.log("peakEndDate",peakEndDate);

                    const isCarInPeakPeriod = peakStartDate <= currentDate && currentDate <= peakEndDate;

                    // 요일에 따라 가격을 선택
                    if (dayOfWeek === 0 || dayOfWeek === 6) { // 일요일(0) 또는 토요일(6)
                        if (isCarInPeakPeriod) {
                            carInfo.textContent = `${car.product_name}\n${car.peak_weekend_price.toLocaleString('ko-KR')}원`;
                        } else {
                            carInfo.textContent = `${car.product_name}\n${car.rental_fee_weekend.toLocaleString('ko-KR')}원`;
                        }
                    } else { // 월~금
                        if (isCarInPeakPeriod) {
                            carInfo.textContent = `${car.product_name}\n${car.peak_weekdays_price.toLocaleString('ko-KR')}원`;
                        } else {
                            carInfo.textContent = `${car.product_name}\n${car.rental_fee_weekdays.toLocaleString('ko-KR')}원`;
                        }
                    }

                    cell.appendChild(carInfo);
                });

                date++;
            }
        }
    }

    container.appendChild(table); // 달력을 컨테이너에 추가합니다.
}


        // 서버에서 차량 데이터를 가져오는 함수
        function fetchCampingCarListForCalendar(year, month) {
            const url = `/api/campingcar/campingCarListForCalendar?year=${year}&month=${month}`;
            
            return fetch(url)
            .then(response => response.json())
            .then(response => {
                if (response.result === 'success') {
                    return response.data.carList;
                } else {
                    console.error('Failed to fetch car list:', response);
                    return [];
                }
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
                return [];
            });
        }

        // 날짜 선택 시 호출되는 함수입니다.
        function selectDay(cell, year, month, day) {
            const previouslySelected = document.querySelector('.selected-day');
            if (previouslySelected) previouslySelected.classList.remove('selected-day'); // 이전에 선택된 날짜의 스타일을 제거합니다.
            cell.classList.add('selected-day'); // 선택된 날짜에 스타일을 추가합니다.

            // 월이 12월(11) 이상일 경우, 다음 해로 넘어가도록 처리
            if (month > 11) {
                month = 0;
                year++;
            }
            // 월이 1월(0) 이하일 경우, 이전 해로 넘어가도록 처리
            if (month < 0) {
                month = 11;
                year--;
            }

            const formattedMonth = String(month + 1).padStart(2, '0'); // 월을 두 자릿수로 포맷합니다.
            const formattedDay = String(day).padStart(2, '0'); // 일을 두 자릿수로 포맷합니다.

            // 선택된 날짜를 모달의 시작일 및 종료일 필드에 설정
            document.getElementById('startDate').value = `${year}-${formattedMonth}-${formattedDay}`;
            document.getElementById('endDate').value = `${year}-${formattedMonth}-${formattedDay}`;

            // 모달을 표시
            showModal();

            console.log(`Year: ${year}, Month: ${formattedMonth}, Day: ${formattedDay}`); // 선택된 날짜를 콘솔에 출력합니다.
        }

        // 모달 열기 함수
        const showModal = () => {
            const exampleModal = document.getElementById('exampleModal');
            const modal = new bootstrap.Modal(exampleModal);
            modal.show();

            // Datepicker 적용
            $('#startDate, #endDate').datepicker({
                format: 'yyyy-mm-dd',
                autoclose: true
            });
        };

        function inputPeakData() {
    const periodType = document.querySelector('.radio-group input[type="radio"]:checked').value;
    const periodName = document.getElementById('periodName').value; // 사용자가 입력한 기간명
    const startDate = document.getElementById('startDate').value;
    const endDate = document.getElementById('endDate').value;

    if (periodType === 'peak') {
        const url = "/api/campingcar/addRentalPeakDate";
        const data = {
            peak_start_date: startDate,
            peak_end_date: endDate
        };

        // 데이터 출력하여 확인
        console.log('Sending data:', JSON.stringify(data));

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
            
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            if (data.result === 'success') {
                alert('성수기 기간이 성공적으로 추가되었습니다.');

                // 사용자 정의 성수기 기간을 동적으로 반영
                const userDefinedPeriods = [
                    { periodName: periodName, startDate: startDate, endDate: endDate }
                ];

                loadCalendarData(currentDate.getFullYear(), currentDate.getMonth(), userDefinedPeriods);

                // 모달 닫기
                const exampleModal = document.getElementById('exampleModal');
                const modal = bootstrap.Modal.getInstance(exampleModal);
                modal.hide(); // 모달을 닫는 메서드
            } else {
                alert('성수기 기간 추가 중 오류가 발생했습니다.');
            }
        })
        .catch(error => {
            console.error('Error adding peak period:', error);
            alert('성수기 기간 추가 중 오류가 발생했습니다.');
        });
    }
}

    </script>
</body>
</html>
