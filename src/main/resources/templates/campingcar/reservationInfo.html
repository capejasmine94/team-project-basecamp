<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org:">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>예약하기</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
     <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
    <link href="/public/css/common.css" rel="stylesheet">
    <script src="/public/js/lockLikeMobile.js"></script>
    <link rel="shotcut icon" href="/public/img/common/campFire.ico" type="image/x-icon">
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        .carousel-item {
            width: 100%;
            height: 100%;
        }
        .carousel-item img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: #f0f0f0; /* 배경색 추가 (필요 시) */
        }
        .section {
            margin-bottom: 5px;
            padding: 16px;
            background-color: #fff;
            border: 1px solid #e0e0e0;
        }
        .section img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
        }
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .section-text {
            font-size: 14px;
            color: #888;
            margin-bottom: 8px;
        }
        .highlight-text {
            color: #ff5e57;
            font-weight: bold;
        }
        .final-price {
            font-size: 24px;
            font-weight: bold;
            color: #007aff;
            text-align: center;
            margin-bottom: 16px;
        }
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 16px 0;
            font-size: 14px;
        }
        .info-item:last-child {
            border-bottom: none;
        }
        .info-item-title {
            color: #333;
            font-weight: bold;
        }
        .info-item-value {
            color: #555;
        }
        .nav-underline {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 8px;
        }

        .nav-underline::-webkit-scrollbar {
            display: none; /* 웹킷 브라우저에서 스크롤바 숨기기 */
        }

        .nav-underline {
            -ms-overflow-style: none;
            scrollbar-width: none; 
        }

        .nav-item {
            flex: 0 0 auto;
        }

        .nav-link {
            white-space: nowrap;
            margin-right: 8px;
            text-decoration: none;
            color: black;
            position: relative; /* 상대적 위치 설정으로 자식 요소에 절대 위치를 지정할 수 있도록 함 */
        }

        .nav-link.active {
            font-weight: bold;
            color: black !important;
            background-color: transparent !important;
        }
        .underline-bg {
            color: inherit;
            border-bottom: 2px solid #e8e8e8;
            box-shadow: inset 0 -0.5em 0 #e8e8e8;
            transition: background .15s cubic-bezier(0.33, 0.66, 0.66, 1);
        }
        .dc-inline-block {
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container-fluid fixed-top">
        <div class="row bg-white align-items-center py-2 border-bottom">
            <div class="col-auto px-0">
                <button class="border-0 bg-transparent d-flex align-items-center text-dark">
                    <span class="material-symbols-outlined" onclick="history.back();" style="cursor: pointer;">arrow_back</span>
                </button>
            </div>
            <div class="col text-center">
                <h5 class="mb-0 fw-semibold" style="font-size: 16px;">예약하기</h5>
            </div>
            <div class="col-1 me-3">
            </div>
        </div>
    </div>
    <form  method="post" enctype="multipart/form-data">
        <div class="container">
            <div class="row">
                <div class="col section">
                    <div class="row new-mt-45">
                        <div class="col">
                            <div class="row">
                                <div class="col fw-medium px-2">
                                    <span class="new-fs-75 bg-body-secondary badge text-body-secondary material-symbols-outlined">rv_hookup<span class="new-fs-65"th:text="${campingcarDetails.campingcarDto.car_type_name}" style="background-color: rgb(241,244,249); color: rgb(123,139,171);">모터홈</span></span>
                                </div>
                            </div>
                            <div class="row pt-2">
                                <div class="col">
                                    <div class="fw-bold fs-5" th:text="${campingcarDetails.campingcarDto.product_name}"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col d-flex justify-content-start align-itmes-center">
                                    <span class="material-symbols-outlined fs-6 pt-1 mt-2 d-flex align-itmes-center" style="color: #424346;">home</span>
                                    <span class="new-fs-85 pt-1 d-flex align-itmes-center" th:text="${campingcarDetails.campingcarDto.comp_name}" style="color: #666666; margin-top: 0.375rem;"></span>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col py-2">
                                    <div class="row">
                                        <div class="col">
                                            <div class="border border-0">
                                                <!-- 출고 가능 시간 -->
                                                <div class="d-flex flex-column justify-content-center align-items-start p-1" style="flex: 1; border-left: none;border-right: none; border-top: none; border-bottom: none;">
                                                    <label for="datetime" class="fw-semibold pb-2" style="font-size: 0.85rem">대여날짜</label>
                                                    <input name="start_date" type="datetime-local" id="datetime" max="2077-06-20T21:00" min="2024-08-07T12:30" svalue="2077-06-15T13:27" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="border border-0">
                                                <!-- 반납 가능 시간 -->
                                                <div class="d-flex flex-column justify-content-center align-items-start p-1" style="flex: 1; border-left: none;border-right: none; border-top: none; border-bottom: none;">
                                                    <label for="datetime" class="text-start fw-semibold pb-2" style="font-size: 0.85rem">반납날짜</label>
                                                    <input name="end_date"type="datetime-local" id="datetime" max="2077-06-20T21:00" min="2024-08-07T12:30" svalue="2077-06-15T13:27" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                                
                            </div>
                            <!-- 렌트카 회사 정보 -->
                            <div class="row">
                                <div class="col">
                                    <div class="row py-3">
                                        <div class="col d-flex justify-content-center">
                                            <button id="toggleButton"  class="btn btn-light new-fs-85 fw-medium" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="true" aria-controls="collapseExample"  style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem; color: #666;">더보기</button>
                                        </div>
                                    </div>
                                    <div class="collapse" id="collapseExample">
                                        <div class="row ps-3 mb-3 pt-3" >
                                            <div class="col-2 d-flex align-items-start info-item">
                                                <span class="fw-semibold new-fs-85">차량정보</span>
                                            </div>
                                            <div class="col-10">
                                                <div class="fw-normal d-flex flex-wrap aling-items-center fs-6" style="word-break: break-word; color: #424346;">
                                                    <div class="d-flex align-itmes-center new-fs-75">
                                                        <span class="material-symbols-outlined" style="color: #7B8BAB;">badge</span>
                                                        <span class="pe-4 pt-1 fw-semibold" style="color: #666;" th:text="${campingcarDetails.campingcarDto.driver_license_name}"></span>
                                                    </div>
                                                    <div class="d-flex align-items-center new-fs-75">
                                                        <span class="material-symbols-outlined" style="color: #7B8BAB;">airline_seat_recline_extra</span>
                                                        <span class="pe-4 pt-1 fw-semibold" style="color: #666;" th:text="${campingcarDetails.campingcarDto.driver_age_condition_name}"></span>
                                                    </div>
                                                    <div class="d-flex align-items-center new-fs-75">
                                                        <span class="material-symbols-outlined" style="color: #7B8BAB;">directions_car</span>
                                                        <span class="pe-4 pt-1 fw-semibold" style="color: #666;" th:text="${campingcarDetails.campingcarDto.driver_experience_condition_name}"></span>
                                                    </div>
                                                    <div class="d-flex align-items-center new-fs-75">
                                                        <span class="material-symbols-outlined" style="color: #7B8BAB;">groups</span>
                                                        <span class="pe-4 pt-1 fw-semibold" style="color: #666;" th:text="'동승인원 ' + ${campingcarDetails.campingcarDto.seating_capacity} + '명'"></span>
                                                    </div>
                                                    <div class="d-flex align-items-center new-fs-75">
                                                        <span class="material-symbols-outlined" style="color: #7B8BAB;">bedroom_parent</span>
                                                        <span class="pe-4 pt-1 fw-semibold" style="color: #666;" th:text="'취침인원 ' + ${campingcarDetails.campingcarDto.sleeping_capacity} + '명'"></span>
                                                    </div>
                                                    <div class="d-flex align-items-center new-fs-75">
                                                        <span class="material-symbols-outlined" style="color: #7B8BAB;">Pets</span>
                                                        <span class="pe-4 pt-1 fw-semibold" style="color: #666;" th:text="'반려동물 ' + ${campingcarDetails.campingcarDto.pet_friendly}"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pt-3 ps-3 border-top">
                                            <div class="col-2 d-flex align-items-center info-item">
                                                <span class="fw-semibold new-fs-85">차량옵션</span>
                                            </div>
                                            <div class="col-10">
                                                <div class="d-flex flex-wrap aling-items-center fs-6">
                                                    <span class="d-flex align-items-center pe-2 mb-2 fw-normal" th:each="facility : ${facilities}" style="word-break: break-word;color: #424346;">
                                                        <!-- <span th:text="${facility.name}"></span> -->
                                                        <span th:if="${facility.name} == '화장실'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">wc</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">화장실</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '샤워실'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">shower</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color:#666">샤워실</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '침대'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">bed</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">침대</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '싱크대'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">kitchen</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">싱크대</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '인덕션'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">local_dining</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">인덕션</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '가스레인지'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">local_fire_department</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">가스레인지</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '전기레인지'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">microwave</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">전기레인지</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '냉장고'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">kitchen</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">냉장고</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '온수기'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">hot_tub</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">온수기</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '테이블'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">table_bar</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">테이블</span>
                                                        </span>
                                                        <span th:if="${facility.name} == 'TV'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">tv</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">TV</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '에어컨'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">ac_unit</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">에어컨</span>
                                                        </span>
                                                        <span th:if="${facility.name} == '무시동히터'" class="d-flex align-items-center new-fs-75">
                                                            <span class="material-symbols-outlined" style="color: #7B8BAB;">water_heater</span>
                                                            <span class="pe-4 pt-1 fw-semibold" style="color: #666;">무시동히터</span>
                                                        </span>
                                                    </span>      
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" th:value="${campingcarDetails.campingcarDto.id}" name="product_id">
        <div class="container">
            <!-- 최초 고객 일 때, isRentUser가 false이면 실행 -->
            <div class="row section" th:if="${!isRentUser}">
                <div class="col form-group px-1 0mx-0">
                    <div class="row">
                        <div class="col section-title">
                            <span class="fs-5 fw-semibold">예약자 정보</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="driver_number" class="control-label new-fs-85 fw-semibold pb-1" style="font-size: 0.875rem;">운전자면허증 번호</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pb-4">
                            <input name="driver_license_number"  type="text" class="form-control" placeholder="운번자면허증 번호를 입력해주세요" id="driver_number">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="driver_license_condition" class="control-label new-fs-85 fw-semibold pb-1" style="font-size: 0.875rem;">운전자 면허 종류</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pb-4">
                            <select class="form-select" aria-label="Default select example" id="driver_license_condition" name="driver_license_id">
                                <option th:value="'selectPlease'" th:text="'운전자 면허증 선택'"></option>
                                <option th:each="driverLicenseDto : ${driverLicense}" 
                                        th:value="${driverLicenseDto.id}" 
                                        th:text="${driverLicenseDto.name}">
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="driver_age_condition" class="control-label new-fs-85 fw-semibold pb-1" style="font-size: 0.875rem;">운전자 최소 연령</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pb-4">
                            <select class="form-select" aria-label="Default select example" id="driver_age_condition" name="driver_age_id">
                                <option th:value="'selectPlease'" th:text="'운전자 최소 연령 선택'"></option>
                                <option th:each="driverAgeCondDto : ${driverAge}" 
                                        th:value="${driverAgeCondDto.id}" 
                                        th:text="${driverAgeCondDto.name}">
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="driver_experience_condition" class="control-label new-fs-85 fw-semibold pb-1" style="font-size: 0.875rem;">운전자 운전 경력</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pb-4">
                            <select class="form-select" aria-label="Default select example" id="driver_experience_condition" name="driver_experience_id">
                                <option th:value="'selectPlease'" th:text="'운전자 운전 경력 선택'"></option>
                                <option th:each="driverExpericneceConDto : ${driverExpericnece}" 
                                        th:value="${driverExpericneceConDto.id}" 
                                        th:text="${driverExpericneceConDto.name}">
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="driverFile" class="form-label new-fs-85 fw-semibold pb-1" style="font-size: 0.875rem;">운전 면허증 사진</label>
                        </div>
                    </div>
                    <div class="row pb-4" style="padding-left: 0.75rem; padding-right: 0.75rem;">
                        <input class="form-control" type="file" id="driverFile" style="font-size: 0.875rem;" placeholder="운전면허증을 등록하세요" name="driveImage" accept="image/*">
                        </div>
                    </div>
                    
                    <div class="row mx-0 px-1">
                        <div class="col p-4 border border-warning border-3 rounded text-center">
                            <div class="row">
                                <div class="col">
                                    <div class="d-flex justify-content-center align-items-center text-center">
                                        <span class="material-symbols-outlined" style="font-size: 48px;">person_apron</span>
                                        <span class="text-danger pe-2" style="font-size: 48px;padding-bottom: 0.55rem;">+</span>
                                        <span class="material-symbols-outlined" style="font-size: 48px;">id_card</span>
                                    </div>
                                    <div class="fw-medium new-fs-65">캠핑카 대여시, 운전자는 운전면허증을 꼭 지참해주세요</div>
                                    <div class="new-fs-6 text-muted fw-semibold text-decoration-underline">면허증 확인 및 계약서 작성이 필요합니다.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mx-0 px-1" th:unless="${!isRentUser}">
                <div class="col border p-4 rounded text-center bg-white">
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-center align-items-center text-center">
                                <span class="material-symbols-outlined" style="font-size: 48px;">person_apron</span>
                                <span class="text-warning pe-2" style="font-size: 48px;padding-bottom: 0.55rem;">+</span>
                                <span class="material-symbols-outlined" style="font-size: 48px;">id_card</span>
                            </div>
                            <div class="fw-medium new-fs-65">캠핑카 대여시, 운전자는 운전면허증을 꼭 지참해주세요</div>
                            <div class="fw-light new-fs-6 text-muted">면허증 확인 및 계약서 작성이 필요합니다.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row section">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col info-item-title py-2">
                                    <div class="fs-5 underline-bg dc-inline-block">자동차 보험</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col info-item">
                                    <div class=" new-fs-95 fw-medium" style="color: #494949;padding-left: 0.75rem;">대인/대물/자손 보상한도 및 자가부담금</div>
                                </div>
                            </div>
                            <div class="row border border-0" style="padding-left: 0.80rem;padding-right: 0.80rem;">
                                <div class="col new-fs-9">
                                    <div class="row text-center bg-light d-flex justify-content-center align-items-center">
                                        <div class="col py-2 border-end border-bottom" style="background-color: #f1f4f9;">
                                            <span class="fw-semibold" style="color: #7B8BAB;">구분</span>
                                        </div>
                                        <div class="col py-2 border-end border-bottom">
                                            <span class="fw-semibold" style="color: #666;">보상한도</span>
                                        </div>
                                        <div class="col py-2 border-bottom">
                                            <span class="fw-semibold" style="color: #666;">자기부담금</span>
                                        </div>
                                    </div>
                                    <div class="row text-center d-flex justify-content-center align-items-center">
                                        <div class="col py-2 border-end border-bottom" style="background-color: #f1f4f9;">
                                            <span class="fw-bold" style="color: #7B8BAB;">대인1·2</span>
                                        </div>
                                        <div class="col py-2 border-end border-bottom d-flex justify-content-center align-items-center">
                                            <span class="fw-medium new-fs-75" style="color: #666;">무한</span>
                                        </div>
                                        <div class="col py-2 border-bottom d-flex justify-content-center align-items-center">
                                            <span class="fw-medium new-fs-75" style="color: #666;">없음</span>
                                        </div>
                                    </div>
                                    <div class="row text-center">
                                        <div class="col py-2 border-end border-bottom d-flex justify-content-center align-items-center" style="background-color: #f1f4f9;">
                                            <span class="fw-bold" style="color: #7B8BAB;">대물</span>
                                        </div>
                                        <div class="col py-2 border-end border-bottom d-flex justify-content-center align-items-center">
                                            <span class="fw-medium new-fs-75" style="color: #666;">최대 2,000만원</span>
                                        </div>
                                        <div class="col py-2 border-bottom d-flex justify-content-center align-items-center">
                                            <span class="fw-medium new-fs-75" style="color: #666;">없음</span>
                                        </div>
                                    </div>
                                    <div class="row text-center">
                                        <div class="col py-2 border-end d-flex justify-content-center align-items-center" style="background-color: #f1f4f9;">
                                            <span class="fw-bold" style="color: #7B8BAB;">자손</span>
                                        </div>
                                        <div class="col py-2 border-end d-flex justify-content-center align-items-center">
                                            <span class="fw-medium new-fs-75" style="color: #666;">최대 1,500만원</span>
                                        </div>
                                        <div class="col py-2 d-flex justify-content-center align-items-center">
                                            <span class="fw-medium new-fs-75" style="color: #666;">없음</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row pt-3 ps-1">
                                <div class="col">
                                    <div class="text-muted new-fs-65">보험은 현장에서 작성하는 계약서를 기준으로 적용합니다.</div>
                                    <div class="text-muted new-fs-65">반드시 계약서를 확인해주시기 바랍니다.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pt-3">
                            <span class="fw-semibold text-muted new-fs-75">위 내용을 모두 확인하였으며, 예약 하기 버튼을 눌러주세요</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row py-2" style="margin-bottom: 45px;">
                <div class="col d-grid"  th:if="${!isRentUser}">
                    <button class="btn btn-dark btn-lg fw-bold" formaction="/campingcar/reservationProcess" style="background-color: #28323C;color: #fff;">예약하기</button>
                </div>
                <div class="col d-grid" th:unless="${!isRentUser}">
                    <button class="btn btn-dark btn-lg fw-bold" formaction="/campingcar/existingRentUserReservationProcess" style="background-color: #28323C;color: #fff;">예약하기</button>
                </div>
            </div>
        </div>
    </form> 
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <!-- 부트스트랩 JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script>
        
        document.addEventListener('DOMContentLoaded', function() {

            //페이지 로드시 예약된 날짜를 가져와서 비활성화 
            reservationById();

            const collapseElement = document.getElementById('collapseExample');
            const toggleButton = document.getElementById('toggleButton');
            const initialButtonContainer = toggleButton.parentElement.parentElement.parentElement;
            const collapseParent = collapseElement.parentElement;

            let isMoved = false; // 버튼의 위치가 변경되었는지 여부를 추적

            toggleButton.addEventListener('click', function () {
                if (isMoved) {
                    // collapse가 닫힐 때 버튼을 원래 위치로 되돌리기
                    initialButtonContainer.appendChild(toggleButton.parentElement.parentElement);
                    isMoved = false;
                } else {
                    // collapse가 열릴 때 버튼을 차량 옵션 아래로 이동시키기
                    collapseParent.appendChild(toggleButton.parentElement.parentElement);
                    isMoved = true;
                }
            });


            function reservationById (){
                const productId = document.querySelector('input[name="product_id"]').value; // hidden input에서 product_id 가져오기
                const url = `api/rent-user/reservationData?product_id=${productId}`;

                fetch(url)
                .then(response => response.json())
                .then(response => {
                    const reservedDates = response.data.reservedDateStrings; 
                    disableReservaedDates(reservedDates);
                });
            }

            function disableReservedDates(reservedDates) {
                const startDateInput = document.querySelector('input[name="start_date"]');
                const endDateInput = document.querySelector('input[name="end_date"]');

                // 예약된 날짜들을 비활성화
                reservedDates.forEach(date => {
                    // "YYYY-MM-DD" 형식으로 입력된 날짜를 처리
                    const disabledDate = date;
                    
                    // 현재 입력 필드에 min 및 max 속성을 통해 비활성화
                    startDateInput.setAttribute('min', getNextAvailableDate(disabledDate, reservedDates));
                    endDateInput.setAttribute('min', getNextAvailableDate(disabledDate, reservedDates));
                });
            }

            function getNextAvailableDate(date, reservedDates) {
                // 다음 사용할 수 있는 날짜를 찾는 함수
                let nextDate = new Date(date);
                nextDate.setDate(nextDate.getDate() + 1); // 하루 추가

                while (reservedDates.includes(nextDate.toISOString().split('T')[0])) {
                    nextDate.setDate(nextDate.getDate() + 1);
                }

                return nextDate.toISOString().split('T')[0];
            }
            
        });
    </script>
</body>
</html>
